"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./_rollupPluginBabelHelpers-7d3a169b.js"),n=require("react"),r=require("file-selector"),t=[];function l(l){var i=l.accept,o=void 0===i?"*":i,a=l.multiple,c=void 0===a||a,u=l.readAs,s=void 0===u?"Text":u,f=l.readFilesContent,d=void 0===f||f,p=l.validators,v=void 0===p?t:p,F=l.initializeWithCustomParameters,m=n.useState([]),C=m[0],y=m[1],h=n.useState([]),S=h[0],b=h[1],k=n.useState([]),x=k[0],g=k[1],_=n.useState(!1),R=_[0],P=_[1],E=function(e){var r=e.onFilesSelected,t=e.onFilesSuccessfullySelected,l=e.onFilesRejected,i=e.onClear,o=e.validators;return{onFilesSelected:n.useCallback((function(e){null==r||r(e),null==o||o.forEach((function(n){n.onFilesSelected(e)}))}),[r,o]),onFilesSuccessfullySelected:n.useCallback((function(e){null==t||t(e),null==o||o.forEach((function(n){n.onFilesSuccessfullySelected(e)}))}),[o,t]),onFilesRejected:n.useCallback((function(e){null==l||l(e),null==o||o.forEach((function(n){n.onFilesRejected(e)}))}),[o,l]),onClear:n.useCallback((function(){null==i||i(),null==o||o.forEach((function(e){null==e.onClear||e.onClear()}))}),[o,i])}}(l),j=E.onFilesSelected,w=E.onFilesSuccessfullySelected,A=E.onFilesRejected,B=E.onClear,M=n.useCallback((function(){y([]),b([]),g([])}),[]),T=n.useCallback((function(){M(),null==B||B()}),[M,B]),q=n.useCallback((function(n){return new Promise(function(){var r=e._asyncToGenerator(e._regeneratorRuntime().mark((function r(t,i){var o,a;return e._regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:(o=new FileReader)["readAs"+s].call(o,n),a=function(n){var r=e._extends({},(e._objectDestructuringEmpty(n),n));i(e._extends({},r))},o.onload=e._asyncToGenerator(e._regeneratorRuntime().mark((function r(){return e._regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.all(v.map((function(e){return e.validateAfterParsing(l,n,o).catch((function(e){return Promise.reject(a(e))}))}))).then((function(){return t(e._extends({},n,{content:o.result,name:n.name,lastModified:n.lastModified}))})).catch((function(){})));case 1:case"end":return r.stop()}}),r)}))),o.onerror=function(){a({name:"FileReaderError",readerError:o.error,causedByFile:n})};case 6:case"end":return r.stop()}}),r)})));return function(e,n){return r.apply(this,arguments)}}())}),[l,s,v]),G=n.useCallback((function(){!function(e,n,r,t){var l=document.createElement("input");l.style.display="none",document.body.appendChild(l),l.type="file","*"!==e&&(l.accept=e),l.multiple=n,l.addEventListener("change",(function(e){r(e),document.body.removeChild(l)})),t&&t(l),l.dispatchEvent(new MouseEvent("click"))}(o instanceof Array?o.join(","):o,c,function(){var n=e._asyncToGenerator(e._regeneratorRuntime().mark((function n(t){var i,o,a,c,u,s;return e._regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(),o=(i=t.target).files?Array.from(i.files):[],P(!0),e.next=6,Promise.all(v.map((function(e){return e.validateBeforeParsing(l,o).catch((function(e){return Array.isArray(e)?e:[e]}))})));case 6:if(a=e.sent.flat(1).filter(Boolean),y(o),g(a),!a.length){e.next=15;break}return P(!1),y([]),null==A||A({errors:a}),null==j||j({errors:a}),e.abrupt("return");case 15:if(d){e.next=19;break}return P(!1),null==j||j({plainFiles:o,filesContent:[]}),e.abrupt("return");case 19:return e.next=21,r.fromEvent(t);case 21:return c=e.sent,u=[],e.next=25,Promise.all(c.map((function(e){return q(e).catch((function(e){u.push.apply(u,Array.isArray(e)?e:[e])}))})));case 25:if(s=e.sent,P(!1),!u.length){e.next=34;break}return y([]),b([]),g((function(e){return[].concat(e,u)})),null==A||A({errors:u}),null==j||j({errors:a.concat(u)}),e.abrupt("return");case 34:b(s),y(o),g([]),null==w||w({filesContent:s,plainFiles:o}),null==j||j({plainFiles:o,filesContent:s});case 39:case"end":return e.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),F)}),[l,o,M,F,c,A,j,w,q,d,v]);return{openFilePicker:G,filesContent:S,errors:x,loading:R,plainFiles:C,clear:T}}exports.useFilePicker=l,exports.useImperativeFilePicker=function(r){var t=r.onFilesSelected,i=r.onFilesSuccessfullySelected,o=r.validators,a=r.onFileRemoved,c=n.useState([]),u=c[0],s=c[1],f=n.useState([]),d=f[0],p=f[1],v=l(e._extends({},r,{onFilesSelected:function(e){var n;if(t)return null!=(n=e.errors)&&n.length?t(e):void t({errors:void 0,plainFiles:[].concat(u,e.plainFiles||[]),filesContent:[].concat(d,e.filesContent||[])})},onFilesSuccessfullySelected:function(e){s((function(n){return n.concat(e.plainFiles)})),p((function(n){return n.concat(e.filesContent)})),i&&i({plainFiles:[].concat(u,e.plainFiles||[]),filesContent:[].concat(d,e.filesContent||[])})}})),F=v.openFilePicker,m=v.loading,C=v.errors,y=v.clear,h=n.useCallback((function(){y(),s([]),p([])}),[y]),S=n.useCallback((function(e){p((function(n){return[].concat(n.slice(0,e),n.slice(e+1))})),s((function(n){var r=n[e];return null==o||o.forEach((function(n){return null==n.onFileRemoved?void 0:n.onFileRemoved(r,e)})),null==a||a(r,e),[].concat(n.slice(0,e),n.slice(e+1))}))}),[o,a]),b=n.useCallback((function(e){var n=u.findIndex((function(n){return n===e}));-1!==n&&S(n)}),[S,u]);return{openFilePicker:F,plainFiles:u,filesContent:d,loading:m,errors:C,clear:h,removeFileByIndex:S,removeFileByReference:b}};
//# sourceMappingURL=index.cjs.production.min.js.map
